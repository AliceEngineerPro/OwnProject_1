SELECT * FROM (SELECT tai.* FROM tb_ammo_info as tai LEFT JOIN (SELECT * FROM (SELECT count(boxId)as Sun,boxId FROM tb_ammo_info GROUP BY boxId ) as aWHERE Sun>20 ) as b ON b.boxId = tai.boxIdWHERE b.boxId is NOT NULL)c LEFT JOIN tb_ammo_info_temp as tait ON c.`code` = tait.`code` LEFT JOIN tb_ammo_box_info_temp AS tabit ON tait.boxId = tabit.id LEFT JOIN tb_ammo_box_info AS tabi ON tabi.id = c.boxId WHERE tabit.id IS NOT NULL AND tabit.boxCode = tabi.boxCode
